\input{preamble.tex}

\spectitle{Datendarstellung}

\begin{document}

\maketitle
\newpage

\tableofcontents
\newpage

\hinweis{Diese Gebrauchsanleitung kann gewiss noch einige Zusatzinfos gebrauchen. Ich nehme Anregungen gerne persönlich in der Bücherei entgegen.}

\section{Übersicht}
\label{sec:overview}
Das Programm speichert Daten zu Büchern, (angemeldeten) Schülern und Mitgliedern der Rund-ums-Lesen-AG, die in der Bücherei mithelfen. Außerdem werden die Ausleihvorgänge gespeichert. Im Folgenden wird näher erläutert, welche Daten genau gespeichert werden.

\subsection{Bücher}
\label{subsec:overview:books}
Zu Büchern werden neben allgemeinen Informationen zum Buch, wie etwa der ISBN oder dem Titel, folgende Daten gespeichert:

\begin{enumerate}
\item ID: eine Zahl, die das Buch eindeutig identifiziert
\item Regal: Das Regal, in dem das Buch zu finden sein sollte
\item Bibliothek: Die virtuelle Bibliothek des Buches; virtuelle Bibliotheken werden \linkandref{subsec:library_group:library}{unten} erläutert
\item Gruppen: Die Gruppen des Buches; sie werden \linkandref{subsec:library_group:group}{ebenfalls unten} erläutert
\item Status: ob das Buch verfügbar, ausgeliehen oder als gelöscht markiert ist
\end{enumerate}

\subsection{Schüler}
\label{subsec:overview:people}
Zu Schülern werden Informationen zur Identifikation gespeichert. Außerdem werden der letzte Tag, an dem bezahlt wurde sowie die maximale Anzahl an Büchern, die gleichzeitig entliehen werden dürfen gespeichert.

\section{Bibliotheken, Gruppen und Leseclubs}
\label{sec:library_group}
Neben der einfachen Speicherung von Büchern, Schülern und wer was ausgeliehen hat, erlaubt das Programm auch eine Einteilung der Bücher und Schüler in unterschiedliche Gruppen und eine einfache Art, Leseclubs zu organisieren

\subsection{Virtuelle Bibliotheken}
\label{subsec:library_group:library}
Jedes Buch wird genau einer virtuellen Bibliothek, im Folgenden nur noch mit ``Bibliothek'' bezeichnet (echte Bibliotheken werden mit ``Bücherei'' bezeichnet), zugeordnet. 
Eine Bibliothek kann man sich wie einen abgetrennten Bereich der Bücherei vorstellen: Jede Bibliothek kann unterschiedlichen Schülern die Ausleihe der ihr angehörenden Bücher erlauben und bestimmt, ob Bezahlung erforderlich ist.

Bibliotheken werden einmalig angelegt und bleiben bestehen, daher ist die Neuerstellung einer Bibliothek eher selten.

\subsubsection{Beispiel}
\label{subsubsec:library_group:library:example}
In einer Beispielbücherei gibt es verschiedene Bücher: solche, die nur Ausliegen und nicht ausgeliehen werden können (z.B. Witzbücher), solche, die normal ausgeliehen werden können und, zeitweise, Bücher die Teil eines Leseclubs sind.

Um diese Bücherei zu verwalten, werden drei Bibliotheken benutzt:

\begin{enumerate}
\item ``main'', die Hauptbibliothek, umfasst alle normalen Bücher. Schüler erhalten Zugang und müssen bezahlt haben, um ausleihen zu können.
\item ``präsenzbestand'' umfasst die Bücher, die nicht ausgeliehen werden sollen. Kein Schüler erhält Zugang.
\item ``leseclub'' umfasst während eines Leseclubs die entsprechenden Bücher. Schüler, die sich für den Leseclub anmelden, erhalten Zugang. Schüler müssen nicht bezahlt haben, um auszuleihen.
\end{enumerate}

\subsubsection{Schüler und Bibliotheken}
\label{subsubsec:library_group:library:people}
Für Schüler wird gespeichert, aus welchen Bibliotheken sie ausleihen können. Außerdem wird für jede Bibliothek gespeichert, ob Schüler innerhalb der letzten 52 Wochen bezahlt haben müssen, um ausleihen zu können.

\subsection{Gruppen}
\label{subsec:library_group:group}
Wenn einige Bücher oft gemeinsam die Bibliothek wechseln (z.B. im Rahmen eines Leseclubs), kann es sinnvoll sein, sie in einer Gruppe zusammenzufassen.

Gruppen sind wie Bibliotheken ein Zusammenschluss aus Büchern, jedoch kann ein Buch im Gegensatz zu den Bibliotheken keiner, einer oder mehreren Gruppen angehören. Eine Gruppe fasst Bücher zusammen, die oft zusammen in eine gemeinsame Bibliothek wechseln.
Gruppen sind wie Bibliotheken langlebig; auch sie werden einmalig erstellt.

\subsubsection{Beispiel}
\label{subsubsec:library_group:group:example}
Da in unserer Beispielbücherei \linkandref{subsubsec:library_group:library:example}{von vorhin} bei jedem Leseclub viele Bücher bewegt werden müssen, werden dafür zwei Gruppen erstellt: ``lc 5-7'' für Leseclub-Bücher für die fünfte bis siebte Klasse und ``lc 8+'' für Leseclub-Bücher ab der achten Klasse.

Wenn jetzt ein Leseclub beginnt, werden alle Bücher der entsprechenden Gruppe gemeinsam in die ``leseclub''-Bibliothek verlegt.

\section{Mitarbeiter}
\label{sec:member}
Die Bücherei wird von Mitgliedern der AG (im Folgenden entweder  ``Mitglieder'' oder ``Mitarbeiter'') verwaltet. Dabei kann man von einfacher Ausleihe über Neuanmeldungen zur Verwaltung eines Leseclubs verschiedene Sachen machen.

\subsection{Berechtigungsstufentabelle}
\label{subsec:member:permission_table}
Da es verschiedene Administrationsaufgaben gibt, die auch verschieden oft ausgeführt werden müssen und verschieden schwere Folgen haben, gibt es für die Mitglieder der Rund-Ums-Lesen-AG, die auch in der Bücherei mithelfen, verschiedene Berechtigungsstufen. Sie sind unten zusammengefasst.

\begin{tabular}{|p{0.2\textwidth}|p{0.2\textwidth}|p{0.25\textwidth}|p{0.15\textwidth}|}\hline
\begin{center}\textbf{Stufe}\end{center} & \begin{center}\textbf{Bemerkung}\end{center} & \begin{center}\textbf{Rechte}\end{center} & \begin{center}\textbf{Nutzungs\-gelegen\-heiten}\end{center}\\
\hline
\hline
Inaktiv / Sus\-pen\-diert und nicht eingeloggt &  & Bücher suchen und betrachten & Immer, falls nichts anderes gebraucht wird\\
\hline
Mitarbeiter & Alle, die in der Bücherei mithelfen wollen & -''- sowie Schüler suchen und betrachten, Ausleihvorgänge suchen und betrachten, Ausleihe und Rückgabe & Bei jeder Ausleihe/Rückgabe\\
\hline
Super\-mitarbeiter & Wer Lust hat, Daten zu hunderten Büchern abzutippen & -''- sowie Bücher erstellen und verwalten & Bei Bucherstellung\\
\hline
Ad\-min\-is\-tra\-tor & Wer Lust hat, sich in alle Möglichkeiten des Programms einzuarbeiten & -''- sowie Schüler erstellen und verwalten, Gruppen erstellen, verwalten und aktivieren, Bibliotheken erstellen und verwalten & Bei Neuanmeldungen und Leseclubs\\
\hline
Super\-administrator &  & -''- sowie Mitglieder erstellen und verwalten & Bei Umstellung der AG\\
\hline
\end{tabular}

\subsection{Die log-Datei}
\label{subsec:member:log}

Während des Betriebs wird eine Log-Datei erstellt, die alle Aktionen speichert. In jeder Zeile befindet sich eine Aktion. Das format der Zeilen ist das Folgende, wobei jeweils sich zwischen eckigen Klammern befindliche Werte ersetzt werden:

\begin{verbatim}
[Datum und Zeit] - [Problemgrad] - [Aktion]: [Nachricht]
\end{verbatim}

\begin{itemize}
\item[Problemgrad] ist dabei \verb#INFO# für normale Infomeldungen und \verb#ERROR#, falls ein halbwegs erwarteter Fehler stattgefunden hat.
\item[Aktion] ist entweder eine Aktion, mit dem in der Textoberfäche verwendeten Namen bezeichnet , \verb#<module># für die Meldung beim Start,
\newline \verb#auth_required_wrapper# für Meldungen bei der Kontrolle des Passworts des eingeloggten Mitglieds, die bei einigen Aktionen stattfindet oder \verb#level_required_wrapper#, falls ein Mitglied versucht hat, eine Aktion auszuführen, zu der es keine Berechtigung hat.
\item[Nachricht] ist eine Aktionsspezifische Nachricht (auf Englisch), die meist das eingeloggte Mitglied enthält und kurz erklärt, was gemacht worden ist.
\end{itemize}

\subsubsection{Beispieldatei}
\label{subsubsec:member:log:examples}

So könnte eine Datei aussehen:

\begin{verbatim}
2019-08-27 12:00:00 - INFO - <module>: core operational
2019-08-27 12:09:33 - INFO - login: login fail Mitglied[SAdmin]
	(Superadministrator)
2019-08-27 12:09:42 - INFO - login: login success Mitglied[SAdmin]
	(Superadministrator)
2019-08-27 12:25:43 - INFO - new_book: Mitglied[SAdmin](Superadministrator)
	created Buch[1]"TestTitel"
2019-08-27 12:33:39 - INFO - edit_person: Mitglied[SAdmin](Superadministrator)
	edited Person[123]"TestNachname, TestVorname"
	setting pay_date to 2019-08-27
2019-08-27 12:43:12 - INFO - view_book: Mitglied[SAdmin](Superadministrator)
	viewed Buch[1]"TestTitel"
2019-08-27 12:46:03 - INFO - logout: logout Mitglied[SAdmin](Superadministrator)
2019-08-27 12:53:56 - INFO - level_required_wrapper: access to view_person
	denied to -----
\end{verbatim}

\hinweis{Die Zeilenumbrüche sind nur der einfacheren Lesbarkeit halber eingefügt; eigentlich wird erst vor dem nächsten Datum gebrochen}

\end{document}